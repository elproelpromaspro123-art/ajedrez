<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Webapp personal para jugar, analizar y estudiar ajedrez sin login." />
    <meta name="theme-color" content="#0f1117" />
    <title>Ajedrez Lab</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="/static/pages/report/styles/app.css?v=20260225_ranked3" />
    <link rel="shortcut icon" href="/static/media/favicon-freechess.ico" type="image/x-icon" />
</head>

<body>
    <header class="topbar">
        <div class="brand">
            <p class="kicker">Uso personal</p>
            <h1>Ajedrez Lab</h1>
            <p class="subtitle">Juega contra bots, analiza partidas y estudia patrones de forma directa.</p>
        </div>
        <div class="topbar-meta">
            <p id="last-update-label">Actualizado: 23 de febrero de 2026</p>
            <p id="perf-metric-load">Carga inicial: --</p>
            <p id="perf-metric-first-eval">1ª eval motor: --</p>
            <p id="perf-metric-explorer">Latencia ECO: --</p>
            <p id="perf-metric-memory">Memoria sesión: --</p>
            <a href="https://www.fide.com/FIDE/handbook/LawsOfChess.pdf" target="_blank"
                rel="noopener noreferrer">Reglas FIDE</a>
        </div>
    </header>

    <nav class="tabs" role="tablist" aria-label="Secciones">
        <button class="tab-btn is-active" data-tab-target="play-section" role="tab" aria-selected="true" aria-controls="play-section" id="tab-play">&#9823; Jugar</button>
        <button class="tab-btn" data-tab-target="analysis-section" role="tab" aria-selected="false" aria-controls="analysis-section" id="tab-analysis">&#128269; Analizar</button>
        <button class="tab-btn" data-tab-target="study-section" role="tab" aria-selected="false" aria-controls="study-section" id="tab-study">&#128218; Estudio</button>
        <button class="tab-btn" data-tab-target="profile-section" role="tab" aria-selected="false" aria-controls="profile-section" id="tab-profile">&#128202; Perfil</button>
    </nav>

    <main class="content">
        <section id="play-section" class="panel is-active" role="tabpanel" aria-labelledby="tab-play">
            <div id="play-panel-grid" class="panel-grid setup-mode">
                <article id="play-board-card" class="card board-card" style="display: none;">
                    <div class="board-with-eval">
                        <div id="play-eval-bar" class="eval-bar">
                            <div id="play-eval-fill" class="eval-fill"></div>
                            <span id="play-eval-label-white" class="eval-label eval-label-white"></span>
                            <span id="play-eval-label-black" class="eval-label eval-label-black"></span>
                        </div>
                        <div class="board-wrap play-board-wrap">
                            <div id="play-board" class="chessboard" aria-label="Tablero para jugar contra bot"></div>
                        </div>
                    </div>
                </article>

                <aside class="card control-card sidebar-card">
                    <!-- Setup Panel (Shown before game starts) -->
                    <div id="play-setup-panel">
                        <h3>&#9814; Nueva Partida</h3>

                        <div class="setup-group">
                            <p class="setup-group-title">Rival</p>
                            <label for="bot-preset">Nivel del bot</label>
                            <select id="bot-preset">
                                <option value="600">Principiante &mdash; 600 ELO</option>
                                <option value="900">B&aacute;sico &mdash; 900 ELO</option>
                                <option value="1200" selected>Intermedio &mdash; 1200 ELO</option>
                                <option value="1500">Club &mdash; 1500 ELO</option>
                                <option value="1800">Avanzado &mdash; 1800 ELO</option>
                                <option value="2100">Experto &mdash; 2100 ELO</option>
                            </select>
                            <label for="bot-custom-elo">ELO personalizado (400-2800)</label>
                            <input id="bot-custom-elo" type="number" min="400" max="2800" step="50"
                                placeholder="Opcional" />
                        </div>

                        <div class="setup-group">
                            <p class="setup-group-title">Preferencias</p>
                            <label for="player-color">Tu color</label>
                            <select id="player-color">
                                <option value="white" selected>&#9812; Blancas</option>
                                <option value="black">&#9818; Negras</option>
                                <option value="random">&#127922; Aleatorio</option>
                            </select>
                            <label for="play-mode">Modo de partida</label>
                            <select id="play-mode">
                                <option value="casual" selected>Clasica (sin rating)</option>
                                <option value="ranked">Clasificatoria (cuenta perfil)</option>
                            </select>
                            <p id="play-mode-note" class="muted">Solo Clasificatoria suma estadisticas, sin ayudas y con color aleatorio.</p>
                            <label for="coach-depth">Profundidad del entrenador</label>
                            <input id="coach-depth" type="range" min="8" max="18" value="12" />
                            <p id="coach-depth-value" class="muted">12</p>
                        </div>

                        <div class="stack-buttons">
                            <button id="play-start-btn" class="primary-btn" type="button">&#9654; Jugar</button>
                            <button id="play-settings-btn" class="ghost-btn settings-launch-btn"
                                type="button">&#9881;&#65039; Ajustes avanzados</button>
                        </div>
                    </div>

                    <!-- Game Panel (Shown during game) -->
                    <div id="play-game-panel" class="play-game-panel" style="display: none;">
                        <!-- Top: Game controls -->
                        <div class="game-controls-row">
                            <button id="play-back-btn" class="ghost-btn" type="button">&#11013; Volver</button>
                            <button id="play-new-game-btn" class="ghost-btn" type="button">&#10227; Nueva</button>
                            <button id="play-flip-btn" class="ghost-btn" type="button">&#8645; Girar</button>
                            <button id="play-resign-btn" class="ghost-btn" type="button">&#9873; Rendirse</button>
                            <button id="play-hint-btn" class="ghost-btn" type="button">&#128161; Pista</button>
                            <button id="play-undo-btn" class="ghost-btn" type="button">&#8617; Deshacer</button>
                            <button id="play-cancel-premove-btn" class="ghost-btn" type="button">&#10006; Pre-move</button>
                        </div>

                        <p id="play-status" class="status-line">Partida en curso</p>
                        <div class="play-live-metrics">
                            <div class="summary-card compact-summary-card">
                                <span>Accuracy</span>
                                <strong id="play-accuracy-score">--</strong>
                            </div>
                            <div class="summary-card compact-summary-card">
                                <span>Pre-move</span>
                                <strong id="play-premove-state">No armado</strong>
                            </div>
                        </div>
                        <div id="play-move-badge" class="move-badge" style="display:none;"></div>

                        <!-- Move Confirmation Bar -->
                        <div id="move-confirm-bar" class="move-confirm-bar">
                            <span class="confirm-text" id="confirm-text">&#191;Jugar Caballo a f3?</span>
                            <button class="confirm-yes" id="confirm-yes-btn" type="button">&#10004; S&#237;</button>
                            <button class="confirm-no" id="confirm-no-btn" type="button">&#10008; No</button>
                        </div>

                        <!-- Move History -->
                        <div class="sidebar-section">
                            <p class="sidebar-section-title">Historial de jugadas</p>
                            <ol id="play-move-list" class="move-list" aria-label="Historial de jugadas"></ol>
                        </div>

                        <!-- Computer Panel (Stockfish) -->
                        <div id="computer-panel" class="computer-panel" style="display:none;">
                            <h4 id="computer-panel-title">&#9889; Tus mejores jugadas</h4>
                            <div id="computer-lines"></div>
                        </div>

                        <!-- Tabbed Panel: Coach / AI Assistant -->
                        <div class="sidebar-tabs-container">
                            <div class="sidebar-tabs" role="tablist" aria-label="Paneles laterales">
                                <button class="sidebar-tab is-active" data-sidebar-tab="coach-tab" role="tab" aria-selected="true" aria-controls="coach-tab" id="sidebar-tab-coach">&#128105;&#127997;
                                    Entrenador</button>
                                <button class="sidebar-tab" data-sidebar-tab="ai-tab" role="tab" aria-selected="false" aria-controls="ai-tab" id="sidebar-tab-ai">&#x1F916; Asistente IA</button>
                            </div>

                            <!-- Coach Tab -->
                            <div id="coach-tab" class="sidebar-tab-content is-active" role="tabpanel" aria-labelledby="sidebar-tab-coach">
                                <div class="coach-feed" id="coach-history-container" aria-live="polite">
                                    <p id="coach-message">&#x2726; Hola. &iexcl;Espero que est&eacute;s preparado para un ajedrez
                                        picante!</p>
                                </div>
                            </div>

                            <!-- AI Tab -->
                            <div id="ai-tab" class="sidebar-tab-content" role="tabpanel" aria-labelledby="sidebar-tab-ai">
                                <div id="ai-chat-messages" class="ai-chat-messages" aria-live="polite">
                                    <div class="ai-msg ai-bot">Hola, soy tu asistente de ajedrez con IA.
                                        Preg&uacute;ntame lo que quieras.</div>
                                </div>
                                <div class="ai-chat-input-wrap">
                                    <input id="ai-chat-input" type="text" placeholder="Preg&uacute;ntame algo..."
                                        autocomplete="off" />
                                    <button id="ai-chat-send" class="primary-btn" type="button">Enviar</button>
                                </div>
                                <div class="ai-audit-panel">
                                    <h5>Auditor&iacute;a IA</h5>
                                    <ul id="ai-action-audit" class="compact-list ai-audit-list" aria-live="polite"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </section>

        <section id="analysis-section" class="panel" role="tabpanel" aria-labelledby="tab-analysis">
            <div class="panel-grid analysis-grid">
                <article class="card control-card">
                    <h3>&#128269; Analisis de partida</h3>
                    <label for="analysis-pgn">PGN</label>
                    <textarea id="analysis-pgn" rows="8" spellcheck="false"
                        placeholder="Pega aqui tu PGN..."></textarea>

                    <label for="analysis-depth">Profundidad de analisis</label>
                    <input id="analysis-depth" type="range" min="8" max="18" value="12" />
                    <p id="analysis-depth-value" class="muted">12</p>

                    <button id="analysis-run-btn" class="primary-btn" type="button">&#9654; Analizar partida</button>
                    <progress id="analysis-progress" value="0" max="100"></progress>
                    <p id="analysis-status" class="status-line">Esperando PGN.</p>

                    <div class="summary-grid">
                        <div class="summary-card highlight-summary-card">
                            <span>Accuracy total</span>
                            <strong id="analysis-overall-accuracy">--</strong>
                        </div>
                        <div class="summary-card">
                            <span>Precision blancas</span>
                            <strong id="analysis-white-accuracy">--</strong>
                        </div>
                        <div class="summary-card">
                            <span>Precision negras</span>
                            <strong id="analysis-black-accuracy">--</strong>
                        </div>
                        <div class="summary-card">
                            <span>Apertura</span>
                            <strong id="analysis-opening">--</strong>
                        </div>
                    </div>

                    <div class="coach-box progress-dashboard-box">
                        <h4>Dashboard local de progreso</h4>
                        <div class="progress-metrics-grid">
                            <div class="summary-card">
                                <span>Racha de estudio</span>
                                <strong id="progress-study-streak">0 d&iacute;as</strong>
                            </div>
                            <div class="summary-card">
                                <span>Partidas guardadas</span>
                                <strong id="progress-games-count">0</strong>
                            </div>
                        </div>
                        <div>
                            <p class="muted">Precisi&oacute;n promedio por semana</p>
                            <div id="progress-weekly-chart" class="progress-weekly-chart"></div>
                        </div>
                        <div class="progress-lists-grid">
                            <div>
                                <p class="muted">Aperturas m&aacute;s jugadas</p>
                                <ul id="progress-top-openings" class="compact-list"></ul>
                            </div>
                            <div>
                                <p class="muted">Errores t&iacute;picos</p>
                                <ul id="progress-common-errors" class="compact-list"></ul>
                            </div>
                        </div>
                    </div>

                    <h4>Clasificaciones</h4>
                    <table class="classification-table">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Blancas</th>
                                <th>Negras</th>
                            </tr>
                        </thead>
                        <tbody id="classification-table-body"></tbody>
                    </table>
                </article>

                <article class="card board-card">
                    <div class="card-header">
                        <h2>Revision jugada a jugada</h2>
                        <div class="inline-actions">
                            <button id="analysis-start-btn" class="ghost-btn" type="button">|&lt;</button>
                            <button id="analysis-prev-btn" class="ghost-btn" type="button">&lt;</button>
                            <button id="analysis-next-btn" class="ghost-btn" type="button">&gt;</button>
                            <button id="analysis-end-btn" class="ghost-btn" type="button">&gt;|</button>
                            <button id="analysis-retry-btn" class="ghost-btn" type="button">Reintentar error</button>
                        </div>
                    </div>
                    <div class="analysis-review-layout">
                        <div class="analysis-board-wrap">
                            <div id="eval-bar" class="eval-bar-wrap">
                                <div id="eval-fill" class="eval-fill"></div>
                                <span id="eval-label-white" class="eval-label white-label"></span>
                                <span id="eval-label-black" class="eval-label black-label"></span>
                            </div>
                            <div class="board-wrap analysis-main-board-wrap">
                                <div id="analysis-board" class="chessboard" aria-label="Tablero de analisis"></div>
                            </div>
                        </div>
                        <div class="analysis-review-side">
                            <p id="analysis-move-meta" class="status-line">No hay analisis cargado.</p>
                            <div class="analysis-eval-graph-box">
                                <div class="analysis-eval-graph-head">
                                    <p class="muted">Grafico de evaluacion</p>
                                    <span id="analysis-graph-legend" class="muted">Stockfish (blancas)</span>
                                </div>
                                <canvas id="analysis-eval-graph" width="640" height="180"
                                    aria-label="Grafico de evaluacion de la partida"></canvas>
                            </div>
                            <ol id="analysis-move-list" class="move-list" aria-label="Lista de jugadas analizadas"></ol>
                            <div class="coach-box">
                                <h4>Explicacion de jugada</h4>
                                <p id="analysis-move-explanation" class="status-line">Selecciona una jugada para ver su explicacion.</p>
                                <button id="analysis-explain-ai-btn" class="ghost-btn" type="button">Explicar con IA</button>
                            </div>
                            <div class="coach-box analysis-retry-box">
                                <h4>Reintentar errores</h4>
                                <p id="analysis-retry-status" class="status-line">Carga una jugada marcada como inexactitud/error/blunder para practicar.</p>
                                <div class="board-wrap analysis-retry-board-wrap">
                                    <div id="analysis-retry-board" class="chessboard" aria-label="Tablero para reintentar jugadas"></div>
                                </div>
                                <div class="analysis-retry-actions">
                                    <button id="analysis-retry-start-btn" class="ghost-btn" type="button">Cargar posicion</button>
                                    <button id="analysis-retry-solution-btn" class="ghost-btn" type="button">Ver linea correcta</button>
                                </div>
                            </div>
                            <div class="coach-box">
                                <h4>Mejores lineas del motor</h4>
                                <ul id="analysis-top-lines" class="line-list"></ul>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </section>

        <section id="study-section" class="panel" role="tabpanel" aria-labelledby="tab-study">
            <!-- Study Landing: 3 Big Category Icons -->
            <div id="study-landing" class="study-landing">
                <header class="study-header">
                    <h2>&#128218; Centro de Estudio</h2>
                    <p>Selecciona una categor&iacute;a para empezar a aprender.</p>
                </header>
                <div class="study-roadmap">
                    <h3>Plan rapido de mejora (20-30 min)</h3>
                    <ol>
                        <li>5 min de aperturas: repasa principios y una linea principal.</li>
                        <li>10-15 min de tacticas: busca amenazas, piezas colgando y mates cortos.</li>
                        <li>10 min de finales: practica rey y peon, oposicion y actividad de torre.</li>
                    </ol>
                    <p class="muted">&#128161; Consejo: analiza tus partidas justo al terminar para fijar errores y aciertos. Usa la pesta&ntilde;a &ldquo;Analizar&rdquo; para ver clasificaciones tipo chess.com.</p>
                </div>
                <div class="study-categories">
                    <button class="study-cat-card" data-study-target="study-openings">
                        <span class="study-cat-icon">&#9823;</span>
                        <span class="study-cat-title">Aperturas</span>
                        <span class="study-cat-desc">Principios, sistemas cl&aacute;sicos y l&iacute;neas
                            principales</span>
                    </button>
                    <button class="study-cat-card" data-study-target="study-tactics">
                        <span class="study-cat-icon">&#9876;</span>
                        <span class="study-cat-title">T&aacute;cticas</span>
                        <span class="study-cat-desc">Mates, celadas, clavadas, horquillas y sacrificios</span>
                    </button>
                    <button class="study-cat-card" data-study-target="study-endgames">
                        <span class="study-cat-icon">&#9812;</span>
                        <span class="study-cat-title">Finales</span>
                        <span class="study-cat-desc">Rey y pe&oacute;n, oposici&oacute;n, torres y t&eacute;cnicas
                            esenciales</span>
                    </button>
                    <button class="study-cat-card" data-study-target="study-lessons">
                        <span class="study-cat-icon">&#127891;</span>
                        <span class="study-cat-title">Lecciones</span>
                        <span class="study-cat-desc">Cursos estructurados e interactivos con mini ejercicios</span>
                    </button>
                </div>
                <div class="resource-links study-links">
                    <a href="https://www.fide.com/FIDE/handbook/LawsOfChess.pdf" target="_blank"
                        rel="noopener noreferrer">&#128220; Leyes oficiales FIDE</a>
                    <a href="https://lichess.org/study" target="_blank" rel="noopener noreferrer">&#128218; Estudios interactivos
                        (Lichess)</a>
                    <a href="https://www.chessprogramming.org/Main_Page" target="_blank"
                        rel="noopener noreferrer">&#9881;&#65039; Referencia t&eacute;cnica de motores</a>
                    <a href="https://www.chess.com/lessons" target="_blank"
                        rel="noopener noreferrer">&#127891; Lecciones Chess.com</a>
                    <a href="https://lichess.org/practice" target="_blank"
                        rel="noopener noreferrer">&#9823; Pr&aacute;ctica en Lichess</a>
                </div>
            </div>

            <!-- INTERACTIVE LESSONS SECTION -->
            <div id="study-lessons" class="study-detail" style="display:none;">
                <button class="study-back-btn" data-study-back>&larr; Volver al Centro de Estudio</button>
                <h2>&#127891; Lecciones Interactivas</h2>
                <p class="study-intro">Cursos guiados para practicar conceptos clave con decisiones inmediatas y feedback corto.</p>

                <div class="lesson-course-grid">
                    <button class="lesson-course-card" data-lesson-id="opening_principles">
                        <strong>Principios de apertura</strong>
                        <span>Desarrollo, control central y seguridad del rey.</span>
                    </button>
                    <button class="lesson-course-card" data-lesson-id="king_pawn_endgames">
                        <strong>Finales de rey y peon</strong>
                        <span>Oposicion, triangulacion y peon pasado.</span>
                    </button>
                    <button class="lesson-course-card" data-lesson-id="basic_tactics">
                        <strong>Tacticas esenciales</strong>
                        <span>Clavadas, horquillas y remates de corto calculo.</span>
                    </button>
                </div>

                <article class="card lesson-practice-card">
                    <h3 id="lesson-title">Selecciona una leccion</h3>
                    <p id="lesson-description" class="study-note">Elige un curso para cargar pasos y un mini ejercicio.</p>
                    <div id="lesson-steps" class="lesson-steps"></div>
                    <div class="lesson-practice-panel">
                        <div class="board-wrap lesson-board-wrap">
                            <div id="lesson-practice-board" class="chessboard" aria-label="Tablero de leccion interactiva"></div>
                        </div>
                        <p id="lesson-prompt" class="status-line">Aun no hay ejercicio cargado.</p>
                        <div id="lesson-options" class="lesson-options"></div>
                        <p id="lesson-feedback" class="status-line"></p>
                    </div>
                </article>
            </div>

            <!-- OPENINGS SECTION -->
            <div id="study-openings" class="study-detail" style="display:none;">
                <button class="study-back-btn" data-study-back>&larr; Volver al Centro de Estudio</button>
                <h2>&#9823; Aperturas</h2>
                <p class="study-intro">Dominar las aperturas te da una base s&oacute;lida para el medio juego.
                    Aqu&iacute; encontrar&aacute;s principios fundamentales y las l&iacute;neas m&aacute;s importantes.
                </p>

                <article class="card opening-explorer-card">
                    <div class="opening-explorer-header">
                        <h3>Explorador ECO</h3>
                        <p>Vista en &aacute;rbol con filtros por color, popularidad y tasa de &eacute;xito.</p>
                    </div>
                    <div class="opening-explorer-filters">
                        <label for="eco-filter-color">Color</label>
                        <select id="eco-filter-color">
                            <option value="white" selected>Blancas</option>
                            <option value="black">Negras</option>
                            <option value="both">Ambos</option>
                        </select>

                        <label for="eco-filter-popularity">Popularidad m&iacute;nima</label>
                        <input id="eco-filter-popularity" type="range" min="0" max="100" value="8" />
                        <p id="eco-filter-popularity-value" class="muted">8%</p>

                        <label for="eco-filter-success">&Eacute;xito m&iacute;nimo</label>
                        <input id="eco-filter-success" type="range" min="30" max="75" value="45" />
                        <p id="eco-filter-success-value" class="muted">45%</p>

                        <label for="eco-search">Buscar apertura/ECO</label>
                        <input id="eco-search" type="text" placeholder="Ej: Siciliana, C50, Najdorf..." />
                    </div>

                    <div class="opening-explorer-grid">
                        <div id="eco-tree" class="eco-tree" role="tree" aria-label="Arbol de aperturas ECO"></div>
                        <div class="eco-detail">
                            <h4 id="eco-detail-title">Selecciona una l&iacute;nea</h4>
                            <p id="eco-detail-meta" class="muted">Se mostrar&aacute; eco, popularidad y &eacute;xito.</p>
                            <div id="eco-detail-board" class="study-diagram"></div>
                            <p id="eco-detail-plan" class="study-note">Plan recomendado aparecer&aacute; aqu&iacute;.</p>
                            <button id="eco-load-play-btn" class="ghost-btn" type="button">Cargar l&iacute;nea en tablero de juego</button>
                        </div>
                    </div>
                </article>

                <div class="study-grid">
                    <article class="card study-card">
                        <h3>Principios de Apertura</h3>
                        <p>Reglas fundamentales que todo jugador debe conocer desde el primer movimiento.</p>
                        <div class="study-diagram"
                            data-fen="r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 2 4"></div>
                        <ul class="compact-list">
                            <li><strong>Controla el centro</strong> con peones en e4/d4 o c4/Nf3.</li>
                            <li><strong>Desarrolla piezas menores</strong> (caballos y alfiles) antes que torres.</li>
                            <li><strong>Enroca pronto</strong> para proteger al rey.</li>
                            <li>No saques la dama demasiado pronto.</li>
                            <li>Conecta las torres antes del medio juego.</li>
                            <li>No muevas la misma pieza dos veces si no es necesario.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Apertura Espa&ntilde;ola (Ruy L&oacute;pez)</h3>
                        <p>1.e4 e5 2.Cf3 Cc6 3.Ab5 &mdash; Presi&oacute;n indirecta sobre el centro. Una de las
                            m&aacute;s estudiadas en la historia.</p>
                        <div class="study-diagram"
                            data-fen="r1bqkbnr/pppp1ppp/2n5/1B2p3/4P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 3 3"></div>
                        <ul class="compact-list">
                            <li>Las negras responden con ...a6 (Morphy) o ...Nf6 (Berlinesa).</li>
                            <li>Busca mantener la tensi&oacute;n central.</li>
                            <li>Ideal para aprender estrategia a largo plazo.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Apertura Italiana</h3>
                        <p>1.e4 e5 2.Cf3 Cc6 3.Ac4 &mdash; El alfil apunta a f7. Juego natural, t&aacute;ctico y
                            din&aacute;mico.</p>
                        <div class="study-diagram"
                            data-fen="r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 3 3"></div>
                        <ul class="compact-list">
                            <li>Variante Giuoco Piano (...Bc5) para juego posicional.</li>
                            <li>Defensa Dos Caballos (...Nf6) para juego agudo.</li>
                            <li>Controla d4 para estabilizar el centro.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Defensa Siciliana</h3>
                        <p>1.e4 c5 &mdash; La respuesta m&aacute;s popular y agresiva contra 1.e4. Juego
                            asim&eacute;trico y combativo.</p>
                        <div class="study-diagram"
                            data-fen="rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq c6 0 2"></div>
                        <ul class="compact-list">
                            <li><strong>Najdorf</strong> (...a6): La variante m&aacute;s popular, flexible y
                                din&aacute;mica.</li>
                            <li><strong>Drag&oacute;n</strong> (...g6): Fianchetto agresivo del alfil.</li>
                            <li><strong>Cl&aacute;sica</strong> (...Nc6): Desarrollo s&oacute;lido.</li>
                            <li><strong>Alapin</strong> (c3): L&iacute;nea antiSiciliana para evitar teor&iacute;a.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Defensa Francesa</h3>
                        <p>1.e4 e6 2.d4 d5 &mdash; S&oacute;lida y estrat&eacute;gica. Las negras aceptan un alfil
                            &ldquo;malo&rdquo; a cambio de contra-ataque.</p>
                        <div class="study-diagram"
                            data-fen="rnbqkbnr/ppp2ppp/4p3/3p4/3PP3/8/PPP2PPP/RNBQKBNR w KQkq d6 0 3"></div>
                        <ul class="compact-list">
                            <li><strong>Variante del Avance</strong> (e5): Espacio pero alfil encerrado.</li>
                            <li><strong>Variante del Cambio</strong> (exd5): Posici&oacute;n sim&eacute;trica.</li>
                            <li>La clave es liberar el alfil de c8.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Caro-Kann</h3>
                        <p>1.e4 c6 &mdash; S&oacute;lida como la Francesa pero sin encerrar el alfil. Ideal para juego
                            posicional.</p>
                        <div class="study-diagram"
                            data-fen="rnbqkbnr/pp1ppppp/2p5/8/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2"></div>
                        <ul class="compact-list">
                            <li>Tras 2.d4 d5, las negras tienen una estructura sana.</li>
                            <li>El alfil de c8 se desarrolla antes que en la Francesa.</li>
                            <li>Favorita de jugadores posicionales como Karpov.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Gambito de Dama</h3>
                        <p>1.d4 d5 2.c4 &mdash; La apertura m&aacute;s jugada a nivel profesional. El blanco lucha por
                            ventaja de espacio.</p>
                        <div class="study-diagram"
                            data-fen="rnbqkbnr/ppp1pppp/8/3p4/2PP4/8/PP2PPPP/RNBQKBNR b KQkq c3 0 2"></div>
                        <ul class="compact-list">
                            <li><strong>Rehusado</strong> (...e6): S&oacute;lido pero pasivo.</li>
                            <li><strong>Aceptado</strong> (...dxc4): Activo, el negro devuelve el pe&oacute;n luego.
                            </li>
                            <li><strong>Eslava</strong> (...c6): Mantiene estructura flexible.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Sistema Londres</h3>
                        <p>1.d4 d5 2.Af4 &mdash; Sistema universal f&aacute;cil de aprender. El blanco juega los mismos
                            movimientos contra casi todo.</p>
                        <div class="study-diagram"
                            data-fen="rnbqkbnr/ppp1pppp/8/3p4/3P1B2/8/PPP1PPPP/RN1QKBNR b KQkq - 1 2"></div>
                        <ul class="compact-list">
                            <li>Desarrollo: Af4, e3, Cf3, Ad3, 0-0.</li>
                            <li>Plan sencillo: c3, Cbd2, avanzar e4.</li>
                            <li>Perfecto para principiantes e intermedios.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Gambitos Populares</h3>
                        <p>Sacrificar material en la apertura por actividad e iniciativa.</p>
                        <div class="study-diagram" data-fen="rnbqkbnr/pppp1ppp/8/4p3/4PP2/8/PPPP2PP/RNBQKBNR b KQkq - 0 2"></div>
                        <ul class="compact-list">
                            <li><strong>Gambito de Rey (1.e4 e5 2.f4):</strong> Sacrificio agresivo por ataque r&aacute;pido al flanco de rey.</li>
                            <li><strong>Gambito de Dama (1.d4 d5 2.c4):</strong> El m&aacute;s s&oacute;lido; busca controlar el centro.</li>
                            <li><strong>Gambito Evans (Bc4, b4):</strong> Sacrifica un pe&oacute;n por desarrollo r&aacute;pido y columnas abiertas.</li>
                            <li><strong>Clave:</strong> La compensaci&oacute;n debe medirse en tiempo, espacio y actividad de piezas.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Trampas de Apertura</h3>
                        <p>Trampas cl&aacute;sicas que debes conocer para no caer (ni para usarlas).</p>
                        <div class="study-diagram" data-fen="r1bqkb1r/pppp1ppp/2n2n2/4p2Q/2B1P3/8/PPPP1PPP/RNB1K1NR w KQkq - 4 4"></div>
                        <ul class="compact-list">
                            <li><strong>Mate Pastor (4.Dh5):</strong> Amenaza mate en f7 en 4 jugadas. F&aacute;cil de evitar con Cf6 o g6.</li>
                            <li><strong>Trampa Legal:</strong> Sacrificio de dama que lleva a mate con caballo y alfil.</li>
                            <li><strong>Trampa Lasker (Caro-Kann):</strong> Captura de pe&oacute;n que pierde pieza por clavada.</li>
                            <li><strong>Principio:</strong> No pierdas tiempo atrapando peones en la apertura; desarrolla primero.</li>
                        </ul>
                    </article>
                </div>
            </div>

            <!-- TACTICS SECTION -->
            <div id="study-tactics" class="study-detail" style="display:none;">
                <button class="study-back-btn" data-study-back>&larr; Volver al Centro de Estudio</button>
                <h2>&#9876; T&aacute;cticas</h2>
                <p class="study-intro">Las t&aacute;cticas son la base del ajedrez. Aprender estos patrones te
                    permitir&aacute; ganar material y crear ataques devastadores.</p>

                <div class="study-grid">
                    <article class="card study-card">
                        <h3>Mate del Pastor</h3>
                        <p>Un patr&oacute;n de mate en 4 jugadas: 1.e4 e5 2.Ac4 Cc6 3.Dh5 Cf6?? 4.Dxf7#. Ataca f7.</p>
                        <div class="study-diagram"
                            data-fen="r1bqkb1r/pppp1Qpp/2n5/4p3/2B1P3/8/PPPP1PPP/RNB1K1NR b KQkq - 0 4"></div>
                        <ul class="compact-list">
                            <li>Nunca saques la dama tan r&aacute;pido si no hay un error claro.</li>
                            <li>Se defiende f&aacute;cilmente con ...g6 o ...De7.</li>
                            <li>No lo uses como arma principal &mdash; solo funciona contra errores.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Clavadas</h3>
                        <p>Una pieza no puede moverse porque expondría una pieza m&aacute;s valiosa detr&aacute;s de
                            ella (o el rey).</p>
                        <div class="study-diagram"
                            data-fen="r1bqk2r/pppp1ppp/2n2n2/2b1p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 4 4"></div>
                        <ul class="compact-list">
                            <li><strong>Clavada absoluta:</strong> La pieza protege al rey y no puede moverse.</li>
                            <li><strong>Clavada relativa:</strong> Moverse pierde material valioso.</li>
                            <li>Los alfiles son los principales creadores de clavadas.</li>
                            <li>Busca clavadas contra el rey o la dama rival.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Horquillas (Tenedores)</h3>
                        <p>Una pieza ataca a dos o m&aacute;s piezas enemigas simult&aacute;neamente. Ganas material
                            inevitablemente.</p>
                        <div class="study-diagram"
                            data-fen="r1bqkb1r/pppp1ppp/2n5/4p2n/4P3/3B1N2/PPPP1PPP/RNBQK2R w KQkq - 4 4"></div>
                        <ul class="compact-list">
                            <li>Los <strong>caballos</strong> crean las horquillas m&aacute;s mort&iacute;feras.</li>
                            <li>Los peones tambi&eacute;n pueden crear horquillas devastadoras.</li>
                            <li>Busca siempre incluir al rey o la dama en la horquilla.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Descubiertas y Doble Jaque</h3>
                        <p>Al mover una pieza, se &ldquo;descubre&rdquo; un ataque de otra pieza detr&aacute;s.
                            Devastador cuando ambas atacan.</p>
                        <div class="study-diagram"
                            data-fen="r1bqk2r/pppp1ppp/2n2n2/2b1p3/2B1P3/5N2/PPPP1PPP/RNBQK2R w KQkq - 4 4"></div>
                        <ul class="compact-list">
                            <li><strong>Doble jaque:</strong> Dos piezas dan jaque a la vez &mdash; solo se puede mover
                                el rey.</li>
                            <li>Busca l&iacute;neas abiertas donde puedas descubrir ataques.</li>
                            <li>A menudo lleva a ganar material decisivo.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Sacrificios T&aacute;cticos</h3>
                        <p>Entregar material a cambio de un ataque imparable o mate. El arte supremo del ajedrez.</p>
                        <div class="study-diagram"
                            data-fen="r2q1bnr/ppp1kBpp/2np4/3NN3/4P3/7P/PPPP1PP1/R1BbK2R b KQ - 2 8"></div>
                        <ul class="compact-list">
                            <li><strong>Sacrificio de alfil en h7:</strong> Patr&oacute;n cl&aacute;sico contra enroque
                                corto.</li>
                            <li><strong>Sacrificio de torre en c3/c6:</strong> Destruye la estructura de peones.</li>
                            <li>Calcula hasta el final antes de sacrificar.</li>
                            <li>Mate de Legal: sacrificio de dama en la apertura.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Mates B&aacute;sicos</h3>
                        <p>Patrones de mate que todo jugador debe reconocer en milisegundos.</p>
                        <div class="study-diagram" data-fen="6k1/5ppp/8/8/8/8/5PPP/4R1K1 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li><strong>Mate de pasillo:</strong> Torre da mate en la &uacute;ltima fila.</li>
                            <li><strong>Mate ahogado:</strong> Cuidado con dejar al rey sin movimientos legales.</li>
                            <li><strong>Mate &aacute;rabe:</strong> Caballo y torre cooperan para dar mate.</li>
                            <li><strong>Mate de anastasia:</strong> Caballo en e7 y torre en la columna h.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Ataques al Rey</h3>
                        <p>Patrones de ataque que surgen cuando el rey rival est&aacute; expuesto.</p>
                        <div class="study-diagram" data-fen="r1b1k2r/ppppqppp/2n2n2/2b1p3/2B1P3/2NP1N2/PPP2PPP/R1BQK2R w KQkq - 4 5"></div>
                        <ul class="compact-list">
                            <li><strong>Sacrificio en h7 (Bxh7+):</strong> Cl&aacute;sico sacrificio de alfil para abrir el enroque.</li>
                            <li><strong>Bater&iacute;a Dama+Alfil:</strong> Alineaci&oacute;n en diagonal apuntando al rey.</li>
                            <li><strong>Columna abierta + torre:</strong> Penetrar por columna g o h contra enroque.</li>
                            <li><strong>Principio:</strong> Atacar con al menos 2 piezas m&aacute;s que las que defienden.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Patrones T&aacute;cticos Avanzados</h3>
                        <p>Combinaciones que requieren c&aacute;lculo preciso y visi&oacute;n t&aacute;ctica.</p>
                        <div class="study-diagram" data-fen="r2qkb1r/ppp2ppp/2np1n2/4p1B1/2B1P1b1/2NP1N2/PPP2PPP/R2QK2R w KQkq - 0 6"></div>
                        <ul class="compact-list">
                            <li><strong>Molino:</strong> Combinaci&oacute;n repetitiva de jaques descubiertos ganando material.</li>
                            <li><strong>Eliminaci&oacute;n del defensor:</strong> Capturar la pieza que protege una casilla clave.</li>
                            <li><strong>Rayos X:</strong> Ataque a trav&eacute;s de una pieza intermedia.</li>
                            <li><strong>Zwischenzug:</strong> Jugada intermedia inesperada antes de recapturar.</li>
                        </ul>
                    </article>
                </div>
            </div>

            <!-- ENDGAMES SECTION -->
            <div id="study-endgames" class="study-detail" style="display:none;">
                <button class="study-back-btn" data-study-back>&larr; Volver al Centro de Estudio</button>
                <h2>&#9812; Finales</h2>
                <p class="study-intro">Los finales son donde se ganan o pierden la mayor&iacute;a de partidas. Dominar
                    estas t&eacute;cnicas te dar&aacute; puntos ELO inmediatos.</p>

                <div class="study-grid">
                    <article class="card study-card">
                        <h3>Rey y Pe&oacute;n vs Rey</h3>
                        <p>El final m&aacute;s b&aacute;sico y esencial. La regla de la oposici&oacute;n decide
                            qui&eacute;n gana.</p>
                        <div class="study-diagram" data-fen="8/8/8/8/8/4k3/4P3/4K3 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li><strong>Oposici&oacute;n:</strong> El rey que est&eacute; frente al otro con un
                                n&uacute;mero impar de casillas entre ellos tiene la oposici&oacute;n.</li>
                            <li>Si tu rey est&aacute; delante del pe&oacute;n, generalmente ganas.</li>
                            <li>Si el rey rival tiene la oposici&oacute;n, generalmente son tablas.</li>
                            <li>Excepto con pe&oacute;n de torre: siempre tablas si el rey defensor llega a la esquina.
                            </li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Cuadrado del Pe&oacute;n</h3>
                        <p>Regla visual para saber si el rey rival puede alcanzar un pe&oacute;n pasado antes de que
                            corone.</p>
                        <div class="study-diagram" data-fen="8/8/8/8/4P3/8/k7/4K3 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li>Dibuja un cuadrado desde el pe&oacute;n hasta la fila 8.</li>
                            <li>Si el rey est&aacute; <strong>dentro</strong> del cuadrado (al mover), atrapa el
                                pe&oacute;n.</li>
                            <li>Si el rey est&aacute; <strong>fuera</strong>, el pe&oacute;n corona.</li>
                            <li>Recuerda: desde la fila 2, el pe&oacute;n puede avanzar 2 casillas.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Finales de Torres</h3>
                        <p>El 50% de los finales involucran torres. Dominar estos principios es cr&iacute;tico.</p>
                        <div class="study-diagram" data-fen="8/8/8/4k3/R7/4PK2/8/4r3 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li><strong>Posici&oacute;n Lucena:</strong> T&eacute;cnica del puente para ganar con torre
                                y pe&oacute;n.</li>
                            <li><strong>Posici&oacute;n Philidor:</strong> T&eacute;cnica defensiva, mantener torre en
                                6a fila.</li>
                            <li>Torres activas &gt; material extra.</li>
                            <li>Cortar al rey rival es prioridad.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Mate con Torre y Rey</h3>
                        <p>T&eacute;cnica b&aacute;sica que debes dominar: forzar al rey rival a la orilla.</p>
                        <div class="study-diagram" data-fen="8/8/8/4k3/8/8/R7/4K3 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li>Paso 1: Corta casillas con la torre (barreras).</li>
                            <li>Paso 2: Acerca tu rey para crear oposici&oacute;n.</li>
                            <li>Paso 3: Empuja al rey rival a la &uacute;ltima fila.</li>
                            <li>Paso 4: Da mate con la torre. M&aacute;ximo 15-20 movimientos.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Peones Pasados</h3>
                        <p>Un pe&oacute;n pasado es aquel que no tiene peones enemigos que lo bloqueen. Son
                            extremadamente poderosos.</p>
                        <div class="study-diagram" data-fen="8/5pk1/8/3P4/8/8/5PK1/8 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li>Un pe&oacute;n pasado protegido es una gran ventaja.</li>
                            <li>Dos peones pasados conectados a menudo ganan.</li>
                            <li>Sacrifica material para crear peones pasados en finales.</li>
                            <li>El candidato m&aacute;s lejano primero (regla de Capablanca).</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Zugzwang</h3>
                        <p>Situaci&oacute;n donde cualquier movimiento empeora la posici&oacute;n. Domina esta idea y
                            ganar&aacute;s finales &ldquo;imposibles&rdquo;.</p>
                        <div class="study-diagram" data-fen="8/8/1p6/1P2k3/1K6/8/8/8 b - - 0 1"></div>
                        <ul class="compact-list">
                            <li>Com&uacute;n en finales de rey y pe&oacute;n.</li>
                            <li>El bando que tiene que mover pierde.</li>
                            <li>Busca triangulaciones para forzar zugzwang al rival.</li>
                            <li>En finales de alfiles del mismo color, el zugzwang es decisivo.</li>
                        </ul>
                    </article>

                    <article class="card study-card">
                        <h3>Finales de Alfiles</h3>
                        <p>Los finales con alfiles tienen reglas propias seg&uacute;n sean del mismo color o diferente.</p>
                        <div class="study-diagram" data-fen="8/5k2/4b3/8/8/3B4/5K2/8 w - - 0 1"></div>
                        <ul class="compact-list">
                            <li><strong>Mismo color:</strong> El bando fuerte puede ganar si logra crear peones pasados en casillas del color opuesto al alfil.</li>
                            <li><strong>Distinto color:</strong> Tienden a tablas incluso con 1-2 peones de ventaja.</li>
                            <li><strong>Alfil bueno vs malo:</strong> Un alfil es &ldquo;malo&rdquo; si sus peones est&aacute;n en casillas de su mismo color.</li>
                            <li><strong>Fortaleza:</strong> Posiciones defensivas inexpugnables con alfil de distinto color.</li>
                        </ul>
                    </article>
                </div>
            </div>

        </section>

        <section id="profile-section" class="panel" role="tabpanel" aria-labelledby="tab-profile">
            <div class="panel-grid profile-grid">
                <article class="card control-card">
                    <h3>&#128100; Perfil y estadisticas</h3>
                    <p class="muted">Solo partidas en modo Clasificatoria contra bots cuentan para este perfil y se sincronizan en DATA_BASE.</p>

                    <div class="summary-grid profile-summary-grid">
                        <div class="summary-card">
                            <span>Partidas</span>
                            <strong id="profile-games-total">0</strong>
                        </div>
                        <div class="summary-card">
                            <span>Win rate</span>
                            <strong id="profile-winrate">0%</strong>
                        </div>
                        <div class="summary-card">
                            <span>Accuracy promedio</span>
                            <strong id="profile-avg-accuracy">0%</strong>
                        </div>
                        <div class="summary-card">
                            <span>ELO estimado</span>
                            <strong id="profile-estimated-elo">1200</strong>
                        </div>
                    </div>

                    <div class="coach-box">
                        <h4>Grafico de ELO</h4>
                        <canvas id="profile-elo-graph" width="720" height="200" aria-label="Grafico de ELO estimado"></canvas>
                        <p id="profile-elo-meta" class="muted">Sin suficientes partidas para estimar tendencia.</p>
                    </div>

                    <div class="coach-box">
                        <h4>Aperturas mas jugadas</h4>
                        <ul id="profile-top-openings" class="compact-list"></ul>
                    </div>
                </article>

                <article class="card board-card">
                    <div class="card-header">
                        <h2>Historial de partidas</h2>
                        <button id="profile-refresh-btn" class="ghost-btn" type="button">Refrescar</button>
                    </div>
                    <table class="classification-table profile-history-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Bot ELO</th>
                                <th>Color</th>
                                <th>Resultado</th>
                                <th>Accuracy</th>
                                <th>Apertura</th>
                                <th>ELO</th>
                            </tr>
                        </thead>
                        <tbody id="profile-history-body"></tbody>
                    </table>
                </article>
            </div>
        </section>
    </main>

    <div id="settings-modal" class="settings-modal" role="dialog" aria-modal="true" aria-label="Ajustes de partida">
        <div class="settings-overlay" id="settings-overlay"></div>
        <div class="settings-content">
            <button class="settings-close" id="settings-close-btn" aria-label="Cerrar ajustes">&times;</button>
            <h3>&#9881; Ajustes de partida</h3>

            <p class="settings-section-title">Asistencia</p>
            <div class="settings-row has-border">
                <label>Comentarios autom&aacute;ticos</label>
                <input type="checkbox" class="chess-toggle" id="set-coach-auto" checked>
            </div>
            <div class="settings-row has-border">
                <label>Pistas</label>
                <input type="checkbox" class="chess-toggle" id="set-hints" checked>
            </div>
            <div class="settings-row has-border">
                <label>Comentarios de movimientos</label>
                <input type="checkbox" class="chess-toggle" id="set-move-comments" checked>
            </div>
            <div class="settings-row has-border">
                <label>Ordenador (motor)</label>
                <input type="checkbox" class="chess-toggle" id="set-computer" checked>
            </div>
            <div class="settings-row has-border">
                <label>Retrocesos</label>
                <input type="checkbox" class="chess-toggle" id="set-takebacks" checked>
            </div>

            <p class="settings-section-title">Tablero</p>
            <div class="settings-row has-border">
                <label>Barra de evaluaci&oacute;n</label>
                <input type="checkbox" class="chess-toggle" id="set-eval-bar" checked>
            </div>
            <div class="settings-row has-border">
                <label>Mostrar jugadas legales</label>
                <input type="checkbox" class="chess-toggle" id="set-legal" checked>
            </div>
            <div class="settings-row has-border">
                <label>Resaltar &uacute;ltima jugada</label>
                <input type="checkbox" class="chess-toggle" id="set-lastmove" checked>
            </div>
            <div class="settings-row has-border">
                <label>Mostrar coordenadas</label>
                <input type="checkbox" class="chess-toggle" id="set-coordinates" checked>
            </div>
            <div class="settings-row has-border">
                <label>Tema de tablero</label>
                <select class="chess-select" id="set-board-theme">
                    <option value="classic" selected>Classic</option>
                    <option value="wood">Wood</option>
                    <option value="midnight">Midnight</option>
                </select>
            </div>
            <div class="settings-row has-border">
                <label>Estilo de piezas</label>
                <select class="chess-select" id="set-piece-theme">
                    <option value="default" selected>Default</option>
                    <option value="neo">Neo</option>
                    <option value="mono">Mono</option>
                </select>
            </div>
            <div class="settings-row has-border">
                <label>Flechas de amenazas</label>
                <input type="checkbox" class="chess-toggle" id="set-threat-arrows">
            </div>
            <div class="settings-row has-border">
                <label>Flechas de sugerencias</label>
                <input type="checkbox" class="chess-toggle" id="set-suggestion-arrows">
            </div>

            <p class="settings-section-title">General</p>
            <div class="settings-row has-border">
                <label>Sonidos de piezas</label>
                <input type="checkbox" class="chess-toggle" id="set-sound" checked>
            </div>
            <div class="settings-row has-border">
                <label>Sonido de error</label>
                <input type="checkbox" class="chess-toggle" id="set-error-sound" checked>
            </div>
            <div class="settings-row has-border">
                <label>Tema de interfaz</label>
                <select class="chess-select" id="set-ui-theme">
                    <option value="dark" selected>Oscuro</option>
                    <option value="light">Claro</option>
                    <option value="auto">Auto</option>
                </select>
            </div>
            <div class="settings-row has-border">
                <label>Animacion de piezas</label>
                <input type="checkbox" class="chess-toggle" id="set-piece-anim" checked>
            </div>
            <div class="settings-row has-border">
                <label>Permitir pre-moves</label>
                <input type="checkbox" class="chess-toggle" id="set-premove" checked>
            </div>
            <div class="settings-row has-border">
                <label>Auto promoci&oacute;n a dama</label>
                <input type="checkbox" class="chess-toggle" id="set-autopromo" checked>
            </div>
            <div class="settings-row has-border">
                <label>Control de Tiempo</label>
                <select class="chess-select" id="set-time-control">
                    <option value="0">Ninguna</option>
                    <option value="60">1 min (Bullet)</option>
                    <option value="180">3 min (Blitz)</option>
                    <option value="300">5 min (Blitz)</option>
                    <option value="600">10 min (R&aacute;pida)</option>
                    <option value="900">15 min (R&aacute;pida)</option>
                    <option value="1800">30 min (Cl&aacute;sica)</option>
                </select>
            </div>
            <div class="settings-row">
                <label>Tipo</label>
                <select class="chess-select" id="set-game-type">
                    <option value="standard">Est&aacute;ndar</option>
                </select>
            </div>
        </div>
    </div>

    <div id="promotion-modal" class="promotion-modal" role="dialog" aria-modal="true" aria-label="Elegir pieza de promoción">
        <div class="promo-overlay"></div>
        <div class="promo-content">
            <button class="promo-piece" data-piece="q"><img src="/static/media/white_queen.svg" alt="Dama" /></button>
            <button class="promo-piece" data-piece="r"><img src="/static/media/white_rook.svg" alt="Torre" /></button>
            <button class="promo-piece" data-piece="b"><img src="/static/media/white_bishop.svg" alt="Alfil" /></button>
            <button class="promo-piece" data-piece="n"><img src="/static/media/white_knight.svg"
                    alt="Caballo" /></button>
        </div>
    </div>

    <!-- End Game Modal -->
    <div id="endgame-modal" class="modal-overlay endgame-modal" role="dialog" aria-modal="true" aria-label="Fin de partida">
        <div class="endgame-content">
            <h2 id="endgame-title">&#161;Victoria!</h2>
            <p id="endgame-reason">por jaque mate</p>

            <div class="endgame-meta-grid">
                <div class="endgame-meta-item">
                    <span>Ganador</span>
                    <strong id="endgame-winner">Blancas</strong>
                </div>
                <div class="endgame-meta-item">
                    <span>Duracion</span>
                    <strong id="endgame-duration">0m 0s</strong>
                </div>
                <div class="endgame-meta-item">
                    <span>Movimientos</span>
                    <strong id="endgame-moves">0</strong>
                </div>
                <div class="endgame-meta-item">
                    <span>Apertura</span>
                    <strong id="endgame-opening">Sin detectar</strong>
                </div>
                <div class="endgame-meta-item">
                    <span>Accuracy tuya</span>
                    <strong id="endgame-accuracy-player">--</strong>
                </div>
                <div class="endgame-meta-item">
                    <span>Accuracy rival</span>
                    <strong id="endgame-accuracy-rival">--</strong>
                </div>
            </div>

            <div id="endgame-impact" class="endgame-impact" style="display:none;"></div>

            <div class="endgame-actions">
                <button id="endgame-analyze-btn" class="primary-btn" type="button">&#128269; Analizar partida</button>
                <button id="endgame-pgn-btn" class="ghost-btn" type="button">&#128190; Descargar PGN</button>
                <button id="endgame-close-btn" class="ghost-btn" type="button">Cerrar</button>
            </div>
        </div>
    </div>

    <audio id="fx-move" src="/static/media/move.mp3"></audio>
    <audio id="fx-capture" src="/static/media/capture.mp3"></audio>
    <audio id="fx-check" src="/static/media/check.mp3"></audio>
    <audio id="fx-castle" src="/static/media/castle.mp3"></audio>
    <audio id="fx-promote" src="/static/media/promote.mp3"></audio>
    <audio id="fx-end" src="/static/media/game_end.mp3"></audio>

    <script src="/static/scripts/vendor/chess.global.js?v=20260223"></script>
    <script src="/static/pages/report/scripts/modules/engine.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/storage.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/ui.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/openings.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/study.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/ai.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/play.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/modules/analysis.js?v=20260225_ranked3"></script>
    <script src="/static/pages/report/scripts/main.js?v=20260225_ranked3"></script>
</body>

</html>
